<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"      
	xmlns:a4j="http://richfaces.org/a4j"
	template="./template/template_login.xhtml">
	
	<ui:define name="title">
        Bancos
    </ui:define>
    <br />
    <ui:define name="content">
    	<div align="center">    	
    		<br />
    		<br />
    		<br />
    		<h:panelGroup id="panel_tabla_bancos">        	
		    	<h:form id="form_tabla_bancos">		    				    		
					<rich:dataTable value="#{bankManagedBean.banks}" var="row" iterationStatusVar="it" id="table" rows="15">
						<rich:column>
							<f:facet name="header">
								<a4j:commandLink execute="@this"
								render="@none" oncomplete="#{rich:component('newPane')}.show()">
								<h:graphicImage value="/resources/images/img-new.png" alt="Nuevo Banco" />							
							</a4j:commandLink>
							</f:facet>
							#{it.index}
						</rich:column>
						<rich:column filterBy="#{row.code}" filterEvent="onkeyup">
							<f:facet name="header">Codigo</f:facet>
							<h:outputText value="#{row.code}" />
						</rich:column>
						<rich:column filterBy="#{row.name}" filterEvent="onkeyup">
							<f:facet name="header">Nombre</f:facet>
							<h:outputText value="#{row.name}" />
						</rich:column>
						<rich:column filterBy="#{row.account}" filterEvent="onkeyup">
							<f:facet name="header">Cuenta</f:facet>
							<h:outputText value="#{row.account}" />
						</rich:column>		
						<rich:column>
							<a4j:commandLink execute="@this"
								render="@none" oncomplete="#{rich:component('confirmPane')}.show()">
								<h:graphicImage value="/resources/images/img-delete.png" alt="delete" />							
							</a4j:commandLink>
						</rich:column>	            			            
						<f:facet name="footer">
							<rich:dataScroller page="#{bankManagedBean.page}" />
						</f:facet>
					</rich:dataTable>
				</h:form>
				
				<rich:popupPanel id="confirmPane" autosized="true">
			        <h:form id="dialog_eliminar_banco_form">
				         Desea eliminar el banco?
				        <a4j:commandButton value="Cancelar" onclick="#{rich:component('confirmPane')}.hide(); return false;" />
				        <a4j:commandButton value="Delete"  onclick="remove(); return false;" />
			        </h:form>
			    </rich:popupPanel>
			    
			      <a4j:jsFunction name="remove" action="#{bankManagedBean.deleteBank}"
						render="table" execute="@this"
            			oncomplete="#{rich:component('confirmPane')}.hide();" />
			    
			    <rich:popupPanel id="editPane" autosized="true">
			    	<h:form id="dialog_editar_banco_form">
			    	</h:form>
			    </rich:popupPanel>
			    
			    <rich:popupPanel id="newPane" header="Nuevo Banco" height="180" width="350" autosized="true">
			    	<h:form id="dialog_nuevo_banco_form">
			    	<rich:graphValidator value="#{bankManagedBean}" id="gv">
			    			<rich:messages for="gv"/>
                			<rich:messages globalOnly="true"/>
					    	<h:panelGrid columns="3">
					    		<h:outputText value="Codigo" />
					    		<h:inputText id="code" value="#{bankManagedBean.currentBank.code}" required="true" />			    		
					    		<rich:message id="codeMsg" for="code" />
					    		
					    		<h:outputText value="Nombre" />
					    		<h:inputText id="name" value="#{bankManagedBean.currentBank.name}" required="true" />
					    		<rich:message id="nameMsg" for="name" />
					    		
					    		<h:outputText value="Cuenta" />
					    		<h:inputText id="account" value="#{bankManagedBean.currentBank.account}" required="true" />			    						    		
					    		<rich:message id="accountMsg" for="account" />
					    	</h:panelGrid>
					    	<a4j:commandButton value="Guardar" action="#{bankManagedBean.addBankAction}" /> &nbsp;
					    	<a4j:commandButton value="Cancelar" onclick="#{rich:component('newPane')}.hide(); return false;" />
				    	</rich:graphValidator>
			    	</h:form>
			    </rich:popupPanel>
					   				    	
	    	</h:panelGroup>
    	</div>
    </ui:define>
	
</ui:composition>